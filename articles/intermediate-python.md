---
title: "Pythonä¸­ç´šè€…ã«ãªã‚‹ãŸã‚ã«Modern Pythonã‚’ç›®æŒ‡ã™"
emoji: "ğŸ’­"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ['python', 'modern']
published: false
---

# ã¯ã˜ã‚ã«

## æœ¬è¨˜äº‹ã®èª­è€…å¯¾è±¡

- Pythonã«æ…£ã‚Œã¦ãã¦ã€æ–°ã—ã„æ–‡æ³•ãƒ»é–‹ç™ºç’°å¢ƒã‚’è¦šãˆãŸã„æ–¹
- ã‚ˆã‚Šãƒ¢ãƒ€ãƒ³ã«è¿‘ã„Pythonç’°å¢ƒãŒæ¬²ã—ã„æ–¹

## æƒ³å®šã—ã¦ã„ãªã„æ–¹

- Pythonè‡ªä½“ãŒåˆã‚ã¦ã®æ–¹
- Pythonä¸Šç´šè€…


## èª¬æ˜ã™ã‚‹ã“ã¨ãƒ»ã—ãªã„ã“ã¨

èª¬æ˜ã™ã‚‹

- ãƒ„ãƒ¼ãƒ«ã®ãŠãŠã¾ã‹ãªèª¬æ˜
- ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ç†ç”±ãƒ»å¬‰ã—ã•
- å‚è€ƒã«ãªã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ»URL

èª¬æ˜ã—ãªã„

- å…·ä½“çš„ãªã‚³ãƒãƒ³ãƒ‰


# Modern Python

å¤§å­¦é™¢ã§ç ”ç©¶ã‚’ã™ã‚‹ã‚ˆã†ã«ãªã£ã¦ã‹ã‚‰ã€é•·ã„æ™‚é–“Pythonã‚’æ›¸ãã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚
ãªãœãªã‚‰ã°ã€ç ”ç©¶ã§åˆ©ç”¨ã—ã‚„ã™ã„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒè±Šå¯Œã€ã‹ã¤ç ”ç©¶ã®ã‚ˆã†ãªã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒã¯ã‚„ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«å¯¾ã—ã¦éå¸¸ã«æœ‰åŠ¹ã§ã‚ã‚‹ãŸã‚ã§ã™ã€‚

ã—ã‹ã—ã€Pythonã¯çŸ­æœŸçš„ã«ã‚³ãƒ¼ãƒ‰ã‚’è©¦ã—ã¦å‹•ä½œã‚’å¤‰æ›´ã§ãã‚‹åˆ†ã€å®‰å®šã—ãŸå‹•ä½œãŒé›£ã—ããªã£ã¦ãã¾ã™ã€‚
ä¾‹ãˆã°ã€C++ãªã©ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’é€šã™å¿…è¦ãŒã‚ã‚‹ãŸã‚ã€è¨­è¨ˆã‚’ã†ã¾ãè€ƒãˆã¦å®Ÿè£…ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ä¸€æ–¹ã€Pythonã¯ã‚¹ã‚¯ãƒªãƒ—ãƒˆè¨€èªãªã®ã§æœ€æ‚ª`é—‡ã®è¨­è¨ˆ`ã‚’ã™ã‚‹ã¨å®Ÿè£…è€ƒãˆãªãã¦ã‚‚ãªã‚“ã¨ã‹ãªã‚Šã¾ã™ã€‚
ãŸã ã€ã“ã®ã‚ˆã†ãªå¾Œå…ˆè€ƒãˆãªã„ã‚³ãƒ¼ãƒ‰ã¯å°†æ¥çš„ã«å¤§ããªè² å‚µã«ãªã‚Šã¾ã™ã€‚
å®Ÿéš›ã€ç· ã‚åˆ‡ã‚ŠãŒè¿‘ã„è«–æ–‡ã«åˆã‚ã›ã¦æ€¥ãƒ”ãƒƒãƒã§æ›¸ã„ãŸã‚³ãƒ¼ãƒ‰ãŒç¾åœ¨è‡ªåˆ†ã®å‰ã«ç«‹ã¡ã¯ã ã‹ã‚Šã€ã¾ãŸ1ã‹ã‚‰è¨­è¨ˆãƒ»å®Ÿè£…ã—ç›´ã™ç¾½ç›®ã«ãªã‚Šã¾ã—ãŸã€‚

Pythonã¯è‰¯ãã‚‚æ‚ªãã‚‚ä»¥ä¸‹ã®ã‚ˆã†ãªç‰¹å¾´ãŒã‚ã‚Šã¾ã™ã€‚

- å‹ã‚’è¨­å®šã—ãªãã¦ã„ã„ï¼ˆãã®åˆ†ã€å¤‰æ•°åã«æ€ã„ã‚’é¦³ã›ã‚‹ï¼‰
- ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒå¤šã„ï¼ˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒãšã‚Œã‚‹ï¼‰
- ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ã‚‚è±Šå¯Œï¼ˆã©ã‚Œã‚’ä½¿ãˆã°ã„ã„ã®ã‹ãŒåˆ†ã‹ã‚Šã¥ã‚‰ã„ï¼‰
- è¨­è¨ˆãŒç”˜ãã¦è‰¯ã„ï¼ˆèª­ã¿è¾›ããªã‚‹ï¼‰


ä»Šå›ã¯ã€ã“ã‚Œã‚‰ã®å•é¡Œã‚’è§£æ±ºã§ãã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãƒ„ãƒ¼ãƒ«ã«ã¤ã„ã¦ã¾ã¨ã‚ã¾ã™ã€‚
ã‚‚ã£ã¨è‡ªåˆ†ã‚‚ã¯ã‚„ãPythonã«æ…£ã‚Œã¦ã„ããŸã„ã§ã™ã­ã€‚


# ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£

Pythonã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ã«ã¯å¤šãã®ç¨®é¡ã®çµ„ã¿åˆã‚ã›ãŒã‚ã‚Šã¾ã™ã€‚
ä»¥å‰[pythonã®ç’°å¢ƒæ§‹ç¯‰æˆ¦äº‰ã«ã‚¤ãƒ©ã‚¹ãƒˆã§çµ‚æ­¢ç¬¦ã‚’ã©ã†ã‚„ã‚‰æ‰“ã¦ãªã„](https://qiita.com/ganariya/items/1bf870275bad7b5ab506)ã¨ã„ã†è¨˜äº‹ã§Pythonã®ç’°å¢ƒã®æ§‹ç¯‰ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã—ãŸã€‚
ãã“ã‹ã‚‰è‡ªåˆ†ã®ç†è§£ã‚‚ã‚ã‚‹ç¨‹åº¦é€²ã¿ã€ä»Šã®Pythonã®ç’°å¢ƒæ§‹ç¯‰ã“ã‚Œã§ã„ã„ã‹ãªã€œã¨æ„Ÿã˜ã‚‹ã‚‚ã®ãŒã‚ã£ãŸãŸã‚ã€ãã‚Œã«ã¤ã„ã¦ã¾ã¨ã‚ã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚

## ãƒ‘ã‚¿ãƒ¼ãƒ³1: pyenv + pipenv

`pyenv`ã¯**è¤‡æ•°ã®Pythonã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç®¡ç†**ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
ä¾‹ãˆã°ã€Python3.7ã€Python3.8ã€Python3.9ã‚’ãã‚Œãã‚Œã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦å¥½ãã«åˆ‡ã‚Šæ›¿ãˆã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚
ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã“ã¨ã«ã‚ˆã£ã¦ã€è¤‡æ•°ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«å¯¾å¿œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
æ˜”ã‹ã‚‰ç¶šã„ã¦ã„ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚³ãƒ¼ãƒ‰ã¯Python2.7ã§ã—ã‹å‹•ã‹ãªã„ã‚“ã ï¼ã¿ãŸã„ãªã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚
ãã®ãŸã‚ã€pyenvã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã‚‹ã¨ã†ã‚Œã—ã„ã‚ã‘ã§ã™ã€‚

ã—ã‹ã—ã€`pyenv`ã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã“ã¨ã¯ã§ãã¾ã™ãŒã€ä»®æƒ³ç’°å¢ƒã‚’ä½œæˆã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚
ã“ã®ä»®æƒ³ç’°å¢ƒã¨ã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã”ã¨ã«åˆ©ç”¨ã™ã‚‹ç’°å¢ƒã®ã“ã¨ã‚’æœ¬è¨˜äº‹ã§ã¯æŒ‡ã—ã¾ã™ã€‚

ã‚‚ã—ä»®æƒ³ç’°å¢ƒã‚’åˆ‡ã‚Šåˆ†ã‘ã‚‰ã‚Œãªã„å ´åˆã‚’è€ƒãˆã¦ã¿ã¾ã™ã€‚
æ©Ÿæ¢°å­¦ç¿’ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé–‹ç™ºã‚’è¡Œã£ãŸå¾Œã€åˆ¥ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒDjangoã®é–‹ç™ºã«ãªã£ãŸã¨ã—ã¾ã™ã€‚
ã“ã®ã¨ãã€æ©Ÿæ¢°å­¦ç¿’ã®pytorchã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯Djangoã«ç›´æ¥å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
å¤§é‡ã«ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå¢—ãˆã¦ãã‚‹ã¨å‹•ä½œã‚‚é‡ããªã‚Šã€å¿…è¦ãªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®æ•´åˆæ€§ãŒå–ã‚Œãªããªã£ã¦ãã¾ã™ã€‚
ãã®ãŸã‚ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã”ã¨ã«ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹ã‚ˆã†ãªä»®æƒ³ç’°å¢ƒãŒå¿…è¦ãªã‚ã‘ã§ã™ã€‚

ãã—ã¦ã€`pipenv`ã¯ã€`ã‚ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®Pythonã«ãŠã„ã¦ã€è¤‡æ•°ã®ä»®æƒ³ç’°å¢ƒã‚’ä½œæˆã™ã‚‹`ã“ã¨ãŒã§ãã¾ã™ã€‚
venvã‚’ãƒ©ãƒƒãƒ—ã™ã‚‹ã‚ˆã†ãªä¾¿åˆ©ãªæ©Ÿèƒ½ãŒpipenvã«ãŸãã•ã‚“å‚™ã‚ã£ã¦ã„ã‚‹ã®ã§ãŠã™ã™ã‚ã§ã™ã€‚
ã¾ãŸã€ã“ã“ã§ã¯è©³ã—ãã¯è¿°ã¹ã¾ã›ã‚“ãŒã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒ­ãƒƒã‚¯ã‚’è¡Œã†ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚

ã¾ã¨ã‚ã‚‹ã¨ã€`pyenv`ã§Pythonè‡ªä½“ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç®¡ç†ã—ã€`pipenv`ã§ç‰¹å®šã®Pythonã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ãŠã‘ã‚‹ä»®æƒ³ç’°å¢ƒã‚’ç®¡ç†ã—ã¾ã™ã€‚
Macã§ã¯brewã§pipenv, pyenvä¸¡æ–¹ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã™ã€‚

## ãƒ‘ã‚¿ãƒ¼ãƒ³2: pyenv + poetry

pyenvã¯å…ˆç¨‹å‡ºã¦ãã¾ã—ãŸã€‚
ä»Šå›ã€æ–°ã—ãå‡ºã¦ããŸã®ã¯poetryã«ãªã‚Šã¾ã™ã€‚

poetryã¯rustã£ã½ããƒ©ã‚¤ãƒ–ãƒ©ãƒªç®¡ç†ãŒã§ãã‚‹ãƒãƒãƒ¼ã‚¸ãƒ£ã®ã‚ˆã†ã§ã™ã€‚
ã¾ã è§¦ã£ãŸã“ã¨ãŒãªã„ãŸã‚è©³ã—ããªã„ã®ã§ã™ãŒã€tomlãƒ•ã‚¡ã‚¤ãƒ«ä¸€ã¤ã§ã™ã¹ã¦ã‚’ç®¡ç†ã™ã‚‹ã‚‰ã—ã„ã§ã™ã€‚

ã‹ãªã‚Šæ–°ã—ã„ãƒãƒãƒ¼ã‚¸ãƒ£ã®ã‚ˆã†ãªã®ã§ã€ä»Šåº¦è§¦ã£ã¦ã¿ãŸã„ã§ã™ã€‚


## å‚è€ƒURL

- [poetry](https://python-poetry.org/docs/)
- [pipenv](https://pipenv-ja.readthedocs.io/ja/translate-ja/basics.html)
- [Pythonã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å‘¨ã‚Šã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚’ç†è§£ã™ã‚‹](https://www.m3tech.blog/entry/python-packaging) ãŠã™ã™ã‚ã§ã™

# å‹ã®å°å…¥

Pythonã¯å‹ä»˜ã‘ã‚’ã—ãªãã¦ã‚‚å‹•ãã‚¹ã‚¯ãƒªãƒ—ãƒˆè¨€èªã§ã™ã€‚
ãã®ãŸã‚ã€åˆæœŸæ®µéšã§ã¯ã‹ãªã‚Šã®ã‚¹ãƒ”ãƒ¼ãƒ‰ã§é–‹ç™ºã§ãã¾ã™ãŒã€å¾ŒåŠã«ãªã£ã¦ãã‚‹ã¨å¤‰æ•°ã«æ€ã„ã‚’é¦³ã›ã‚‹æ™‚é–“ãŒé•·ããªã‚Šã€å®Ÿè¡Œæ™‚ã‚¨ãƒ©ãƒ¼ã«æ‚©ã¾ã•ã‚Œã‚‹ã“ã¨ãŒå¤šããªã‚Šã¾ã™ã€‚

ãã“ã§ã€Python3.5ã‹ã‚‰å°å…¥ã•ã‚ŒãŸ`typing`ãªã©ã‚’åˆ©ç”¨ã—ã¦å‹å®‰å…¨ã«ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
ã—ã‹ã—ã€**å®Ÿè¡Œæ™‚ã«å‹ãŒç•°ãªã£ã¦ã‚‚ã‚¨ãƒ©ãƒ¼ã‚’å‡ºã•ãªã„**ã“ã¨ã«æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚
å®Ÿè¡Œæ™‚ã«æ­¢ã¾ã‚‹ã‚ã‘ã§ã¯ãªãã€IDEãªã©ã§ãŠã‹ã—ã„éƒ¨åˆ†ã‚’æŒ‡æ‘˜ã•ã‚Œã‚„ã™ããªã‚Šã¾ã™ã€‚

## typing

```python
def greeting(name: str) -> str:
    return 'Hello ' + name
```

Python3.5ã‹ã‚‰ã€ä¸Šè¨˜ã®ã‚ˆã†ã«å¤‰æ•°ã‚„é–¢æ•°ãªã©ã«å‹ã‚’æŒ‡å®šã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚
å‹ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€IDEã®æ©æµã‚’å—ã‘ã‚„ã™ããªã‚Šã¾ã™ã€‚
ã¾ãŸã€é•·æœŸçš„ã«è¦‹ã‚‹ã¨ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®åŠ¹ç‡åŒ–ã«ç¹‹ãŒã‚Šã¾ã™ã€‚

`Final`ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚‚ã‚ã‚Šã€ã‚ˆã‚Šå®šæ•°ãªã©ã‚’å®‰å…¨ã«è¨­å®šã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã™ã€‚


è©³ã—ãã¯å‚è€ƒURLã‚’å¾¡è¦§ãã ã•ã„ã€‚

## data classes

ãƒ‡ãƒ¼ã‚¿ã‚’æ ¼ç´ã™ã‚‹ã‚¯ãƒ©ã‚¹ã‚’ã‚ˆã‚Šç°¡å˜ã«ä½œæˆã™ã‚‹ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ãªã©ã‚’æä¾›ã—ã¾ã™ã€‚

```python
rom dataclasses import dataclass

@dataclass
class InventoryItem:
    """Class for keeping track of an item in inventory."""
    name: str
    unit_price: float
    quantity_on_hand: int = 0

    def total_cost(self) -> float:
        return self.unit_price * self.quantity_on_hand
```

## namedtuple

åå‰ã‚’ã¤ã‘ãŸã‚¿ãƒ—ãƒ«ã‚’å®£è¨€ã§ãã¾ã™ã€‚
æ›¸ãæ›ãˆã‚‰ã‚Œãªã„ãƒ‡ãƒ¼ã‚¿ã‚’ä¿è¨¼ã§ãã‚‹ã®ã§ã€å¤‰æ›´ã—ãªã„ã‚‚ã®ã‚’ç®¡ç†ã™ã‚‹ã«ã¯ä¾¿åˆ©ãã†ã§ã™ã€‚

## ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹

## pydantic

FastAPIã§æ¡ç”¨ã•ã‚Œã¦ã„ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚
å®Ÿè¡Œæ™‚ã«å‹æƒ…å ±ã‚’æä¾›ã—ã¦ãã‚Œã¾ã™ã€‚

```python
from datetime import datetime
from typing import List, Optional
from pydantic import BaseModel


class User(BaseModel):
    id: int
    name = 'John Doe'
    signup_ts: Optional[datetime] = None
    friends: List[int] = []
    
external_data = {
    'id': '123',
    'signup_ts': '2019-06-01 12:22',
    'friends': [1, 2, '3'],
}
user = User(**external_data)
```

å‹ãŒã‚ã£ã¦ã„ãªã„ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿ãŒå…¥ã‚‹ã¨**å®Ÿè¡Œæ™‚ã§ã‚‚**ä¾‹å¤–ã‚’æŠ•ã’ã¦ãã‚Œã¾ã™ã€‚
ï¼ˆä¸€æ–¹typingãªã©ã¯æŠ•ã’ã¾ã›ã‚“ã€‚ãã®ãŸã‚ã€ã‚ˆã‚Šå‹ã§ãŠã‹ã—ã„ç®‡æ‰€ãŒã‚ã‹ã‚Šã‚„ã™ãã€å …ç‰¢æ€§ãŒä¸ŠãŒã‚Šã¾ã™ã€‚ï¼‰

## å‚è€ƒURL

- [typings](https://docs.python.org/ja/3/library/typing.html)
- [dataclasses](https://docs.python.org/ja/3.9/library/dataclasses.html)
- [namedtuple](https://docs.python.org/ja/3/library/collections.html#collections.namedtuple)

